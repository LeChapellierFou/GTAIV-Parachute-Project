--[[
    Base jumping script
	Parachute Project GTA IV By LeChapellierFou, 10/09/2025
]]

-- Variables globales
local state = 1
local blips = {}
local currentJump = {x=0.0, y=0.0, z=0.0, h=0.0}
local parachuteWeaponId = 41
local Zground = 0
local version = "1.0.1"

-- blip position
local startjumpPoints = {
    {x=-346.50270000, y=-100.84520000, z=14.00000000}, -- TARGET_EMPIRE_STATE
    {x=27.89800000, y=178.81650000, z=13.76290000},    -- TARGET_JUMP_CHRYSLER
    {x=-29.05440000, y=68.82000000, z=13.77910000},    -- TRUCK_JUMP_GETALIFE
    {x=-187.71410000, y=346.46700000, z=14.00000000},    -- TRUCK_JUMP_PIRATE
    {x=-174.27040000, y=205.10870000, z=13.75790000},    -- TARGET_JUMP_BAWSAQ
    {x=-218.71780000, y=229.59520000, z=13.76960000},    -- TRUCK_JUMP_METV
    {x=-180.13420000, y=17.25550000, z=13.72320000},    -- TARGET_JUMP_TRIANGLE
    {x=1282.68600000, y=603.22330000, z=37.99520000},    -- TARGET_MEADOWS_PARK
    {x=-1287.54500000, y=884.57500000, z=18.56640000}    -- TRUCK_ALDERNEY_BUILDING
    
}

local fU12 = {}
local fU400 = {}
local fU12 = {}

local function TeleportPositions(I)
	if(I == 1) then
		fU12[0] = {-285.06000000, -101.46000000, 419.15790000};
		fU400[0] = 190.81560000;
		fU12[1] = {-283.39000000, -101.25000000, 419.15790000};
		fU400[1] = 191.81560000;
		fU12[2] = {-283.00000000, -99.49000000, 419.15790000};
		fU400[2] = 10.81560000;
		fU12[3] = {-284.90000000, -99.44000000, 419.15790000};
		fU400[3] = 9.81560000;
		fU12[4] = {-287.19000000, -103.28000000, 389.63000000};
		fU400[4] = 133.03000000;
		fU12[5] = {-283.88000000, -104.84000000, 389.63000000};
		fU400[5] = 177.88000000;
		fU12[6] = {-286.81000000, -96.78000000, 389.62000000};
		fU400[6] = 35.55000000;
		fU12[7] = {-288.68000000, -100.51000000, 389.62000000};
		fU400[7] = 89.99000000;
		fU12[8] = {-280.21000000, -97.83999000, 389.63000000};
		fU400[8] = -54.45000000;
		fU12[9] = {-283.97000000, -95.68000000, 389.62000000};
		fU400[9] = 0.00000000;
		fU12[10] = {-281.14000000, -104.37000000, 389.62000000};
		fU400[10] = -140.17000000;
		fU12[11] = {-279.12000000, -100.37000000, 389.62000000};
		fU400[11] = -91.10000000;
		fU12[12] = {-291.17000000, -118.28000000, 328.49000000};
		fU400[12] = 179.54000000;
		fU12[13] = {-276.00000000, -118.17000000, 328.49000000};
		fU400[13] = 179.54000000;
		fU12[14] = {-287.43000000, -118.28000000, 328.49000000};
		fU400[14] = 179.54000000;
		fU12[15] = {-283.97000000, -118.29000000, 328.49000000};
		fU400[15] = 179.54000000;
		fU12[16] = {-281.08000000, -118.29000000, 328.49000000};
		fU400[16] = 179.54000000;
		fU12[17] = {-254.68000000, -113.77000000, 311.28000000};
		fU400[17] = -90.44000000;
		fU12[18] = {-254.62000000, -107.12000000, 311.28000000};
		fU400[18] = -90.44000000;
		fU12[19] = {-254.74000000, -100.35000000, 311.28000000};
		fU400[19] = -90.44000000;
		fU12[20] = {-254.76000000, -93.63000000, 311.28000000};
		fU400[20] = -90.44000000;
		fU12[21] = {-254.64000000, -86.66000000, 311.28000000};
		fU400[21] = -90.44000000;
		fU12[22] = {-275.67000000, -82.65000000, 328.49000000};
		fU400[22] = 0.00000000;
		fU12[23] = {-279.99000000, -82.65000000, 328.49000000};
		fU400[23] = 0.00000000;
		fU12[24] = {-283.61000000, -82.74000000, 328.49000000};
		fU400[24] = 0.00000000;
		fU12[25] = {-287.81000000, -82.64000000, 328.49000000};
		fU400[25] = 0.00000000;
		fU12[26] = {-292.01000000, -82.72000000, 328.49000000};
		fU400[26] = 0.00000000;
		fU12[27] = {-313.21000000, -86.82000000, 311.28000000};
		fU400[27] = 90.00000000;
		fU12[28] = {-313.35000000, -93.72000000, 311.28000000};
		fU400[28] = 90.00000000;
		fU12[29] = {-313.11000000, -100.55000000, 311.28000000};
		fU400[29] = 90.00000000;
		fU12[30] = {-313.29000000, -107.39000000, 311.28000000};
		fU400[30] = 90.00000000;
		fU12[31] = {-313.26000000, -114.25000000, 311.28000000};
		fU400[31] = 90.00000000;

		local rdn = math.random(1, 31)
		local x, y, z = fU12[rdn][1], fU12[rdn][2], fU12[rdn][3]
		local h = fU400[rdn]
		return x, y, z, h
	elseif(I == 2) then
        fU12[0] = {9.25000000, 162.39000000, 228.47000000};
        fU400[0] = -133.03000000;
        fU12[1] = {13.55000000, 166.63000000, 228.47000000};
        fU400[1] = -133.03000000;
        fU12[2] = {6.05000000, 163.40000000, 228.46300000};
        fU400[2] = 179.42000000;
        fU12[3] = {12.62000000, 169.54000000, 228.48000000};
        fU400[3] = -89.06000000;
        fU12[4] = {13.41000000, 191.31000000, 228.48000000};
        fU400[4] = -45.45000000;
        fU12[5] = {9.28000000, 195.56000000, 228.48000000};
        fU400[5] = -45.45000000;
        fU12[6] = {12.51000000, 188.39000000, 228.47000000};
        fU400[6] = -90.00000000;
        fU12[7] = {6.31000000, 194.65000000, 228.46000000};
        fU400[7] = 0.00000000;
        fU12[8] = {-15.53000000, 195.57000000, 228.48000000};
        fU400[9] = 45.92000000;
        fU12[9] = {-19.73000000, 191.34000000, 228.48000000};
        fU400[9] = 45.92000000;
        fU12[10] = {-12.35000000, 194.58000000, 228.44000000};
        fU400[10] = 0.00000000;
        fU12[11] = {-18.77000000, 188.41000000, 228.47000000};
        fU400[11] = 90.00000000;
        fU12[12] = {-19.67000000, 166.56000000, 228.48000000};
        fU400[12] = 137.45000000;
        fU12[13] = {-15.46000000, 162.34000000, 228.48000000};
        fU400[13] = 137.45000000;
        fU12[14] = {-18.67000000, 169.65000000, 228.47000000};
        fU400[14] = 90.28000000;
        fU12[15] = {-12.38000000, 163.30000000, 228.45000000};
        fU400[15] = -176.63000000;
        fU12[16] = {10.61000000, 163.25000000, 220.35000000};
        fU400[16] = 179.42000000;
        fU12[17] = {12.66000000, 165.49000000, 220.35000000};
        fU400[17] = -90.12000000;
        fU12[18] = {12.64000000, 192.61000000, 220.36000000};
        fU400[18] = -90.00000000;
        fU12[19] = {10.71000000, 194.70000000, 220.35000000};
        fU400[19] = 0.00000000;
        fU12[20] = {-16.74000000, 194.68000000, 220.33000000};
        fU400[20] = 0.00000000;
        fU12[21] = {-18.74000000, 192.39000000, 220.33000000};
        fU400[21] = 90.00000000;
        fU12[22] = {-18.77000000, 165.27000000, 220.33000000};
        fU400[22] = 90.00000000;
        fU12[23] = {-16.61000000, 163.24000000, 220.33000000};
        fU400[23] = -178.92000000;
        fU12[24] = {-18.63000000, 185.24000000, 228.47000000};
        fU400[24] = 90.00000000;
        fU12[25] = {-18.64000000, 182.46000000, 228.47000000};
        fU400[25] = 90.00000000;
        fU12[26] = {-18.59000000, 176.81000000, 228.47000000};
        fU400[26] = 90.00000000;
        fU12[27] = {-18.64000000, 172.63000000, 228.47000000};
        fU400[27] = 90.00000000;
        fU12[28] = {12.49000000, 172.06000000, 228.47300000};
        fU400[28] = -90.00000000;
        fU12[29] = {12.51000000, 176.73000000, 228.47000000};
        fU400[29] = -90.00000000;
        fU12[30] = {12.50000000, 181.45000000, 228.47000000};
        fU400[30] = -90.00000000;
        fU12[31] = {12.46000000, 185.81000000, 228.47000000};
        fU400[31] = -90.00000000;
		local rdn = math.random(0, 31)
		local x, y, z = fU12[rdn][1], fU12[rdn][2], fU12[rdn][3]
		local h = fU400[rdn]
		return x, y, z, h
	elseif(I == 3) then
		fU12[0] = {-24.03000000, 54.00000000, 219.31000000};
        fU400[0] = 167.34000000;
        fU12[1] = {-20.11000000, 53.06000000, 219.31000000};
        fU400[1] = 167.34000000;
        fU12[2] = {-16.71000000, 52.43000000, 219.31000000};
        fU400[2] = 167.34000000;
        fU12[3] = {-13.48000000, 51.64000000, 219.31000000};
        fU400[3] = 167.34000000;
        fU12[4] = {-9.69999900, 50.96000000, 219.31000000};
        fU400[4] = 167.34000000;
        fU12[5] = {-5.70000000, 50.00000000, 219.31000000};
        fU400[5] = 167.34000000;
        fU12[6] = {-2.28000000, 49.30000000, 219.31000000};
        fU400[6] = 167.34000000;
        fU12[7] = {1.20000000, 48.43000000, 219.31000000};
        fU400[7] = 167.34000000;
        fU12[8] = {9.29000000, 47.97000000, 219.31000000};
        fU400[9] = -179.15000000;
        fU12[9] = {14.79000000, 48.05000000, 219.31000000};
        fU400[9] = -179.15000000;
        fU12[10] = {18.95000000, 48.01000000, 219.31000000};
        fU400[10] = -179.15000000;
        fU12[11] = {22.82000000, 47.93000000, 219.31000000};
        fU400[11] = -179.15000000;
        fU12[12] = {26.17000000, 47.92000000, 219.31000000};
        fU400[12] = -179.15000000;
        fU12[13] = {29.84000000, 47.78000000, 219.31000000};
        fU400[13] = -179.15000000;
        fU12[14] = {34.11000000, 47.83000000, 219.31000000};
        fU400[14] = -179.15000000;
        fU12[15] = {39.01000000, 47.74000000, 219.31000000};
        fU400[15] = -179.15000000;
        fU12[16] = {69.53000000, 71.42000000, 219.31000000};
        fU400[16] = -12.83000000;
        fU12[17] = {65.28000000, 72.51000000, 219.31000000};
        fU400[17] = -12.83000000;
        fU12[18] = {61.75000000, 73.35000000, 219.31000000};
        fU400[18] = -12.83000000;
        fU12[19] = {57.71000000, 74.32000000, 219.31000000};
        fU400[19] = -12.83000000;
        fU12[20] = {53.80000000, 75.11000000, 219.31000000};
        fU400[20] = -12.83000000;
        fU12[21] = {50.02000000, 76.15000000, 219.31000000};
        fU400[21] = -12.83000000;
        fU12[22] = {46.33000000, 76.88000000, 219.31000000};
        fU400[22] = -12.83000000;
        fU12[23] = {42.50000000, 77.90000000, 219.31000000};
        fU400[23] = -12.83000000;
        fU12[24] = {36.97000000, 78.09000000, 219.31000000};
        fU400[24] = 0.00000000;
        fU12[25] = {31.31000000, 78.02000000, 219.31000000};
        fU400[25] = 0.00000000;
        fU12[26] = {27.77000000, 78.01000000, 219.31000000};
        fU400[26] = 0.00000000;
        fU12[27] = {23.99000000, 78.16000000, 219.31000000};
        fU400[27] = 0.00000000;
        fU12[28] = {20.84000000, 78.19000000, 219.31000000};
        fU400[28] = 0.00000000;
        fU12[29] = {17.72000000, 78.21000000, 219.31000000};
        fU400[29] = 0.00000000;
        fU12[30] = {14.30000000, 78.25000000, 219.31000000};
        fU400[30] = 0.00000000;
        fU12[31] = {11.04000000, 78.35000000, 219.31000000};
        fU400[31] = 0.00000000;
		local rdn = math.random(0, 31)
		local x, y, z = fU12[rdn][1], fU12[rdn][2], fU12[rdn][3]
		local h = fU400[rdn]
		return x, y, z, h
	elseif(I == 4) then
		fU12[0] = {-172.55000000, 339.39000000, 244.48000000};
        fU400[0] = 88.58000000;
        fU12[1] = {-168.53000000, 342.57000000, 244.48000000};
        fU400[1] = -30.00000000;
        fU12[2] = {-168.45000000, 336.20000000, 244.48000000};
        fU400[2] = -138.05000000;
        fU12[3] = {-167.32000000, 349.59000000, 202.44000000};
        fU400[3] = 0.00000000;
        fU12[4] = {-168.44000000, 348.05000000, 202.44000000};
        fU400[4] = 90.00000000;
        fU12[5] = {-167.27000000, 329.23000000, 202.44000000};
        fU400[5] = 179.06000000;
        fU12[6] = {-168.45000000, 330.80000000, 202.44000000};
        fU400[6] = 90.00000000;
        fU12[7] = {-113.02000000, 329.29000000, 181.42000000};
        fU400[7] = -90.00000000;
        fU12[8] = {-112.97000000, 331.80000000, 181.42000000};
        fU400[9] = -90.00000000;
        fU12[9] = {-112.99000000, 334.63000000, 181.42000000};
        fU400[9] = -90.00000000;
        fU12[10] = {-112.97000000, 337.32000000, 181.42000000};
        fU400[10] = -90.00000000;
        fU12[11] = {-112.99000000, 339.48000000, 181.42000000};
        fU400[11] = -90.00000000;
        fU12[12] = {-113.01000000, 341.48000000, 181.42000000};
        fU400[12] = -90.00000000;
        fU12[13] = {-113.09000000, 343.67000000, 181.42000000};
        fU400[13] = -90.00000000;
        fU12[14] = {-113.06000000, 345.96000000, 181.42000000};
        fU400[14] = -90.00000000;
        fU12[15] = {-113.09000000, 347.83000000, 181.42000000};
        fU400[15] = -90.00000000;
        fU12[16] = {-113.03000000, 349.69000000, 181.42000000};
        fU400[16] = -90.00000000;
        fU12[17] = {-160.55000000, 327.23000000, 167.60000000};
        fU400[17] = 90.00000000;
        fU12[18] = {-160.58000000, 325.14000000, 167.60000000};
        fU400[18] = 90.00000000;
        fU12[19] = {-160.56000000, 323.35000000, 167.60000000};
        fU400[19] = 145.45000000;
        fU12[20] = {-158.69000000, 323.35000000, 167.60300000};
        fU400[20] = -181.15000000;
        fU12[21] = {-156.58000000, 323.31000000, 167.60000000};
        fU400[21] = -181.15000000;
        fU12[22] = {-154.63000000, 323.30000000, 167.60000000};
        fU400[22] = -181.15000000;
        fU12[23] = {-152.56000000, 323.28000000, 167.60000000};
        fU400[23] = -181.15000000;
        fU12[24] = {-150.64000000, 323.20000000, 167.60000000};
        fU400[24] = -181.15000000;
        fU12[25] = {-160.63000000, 351.60000000, 167.60000000};
        fU400[25] = 90.00000000;
        fU12[26] = {-160.61000000, 353.16000000, 167.60000000};
        fU400[26] = 90.00000000;
        fU12[27] = {-160.52000000, 355.43000000, 167.60000000};
        fU400[27] = 34.76000000;
        fU12[28] = {-158.69000000, 355.47000000, 167.60000000};
        fU400[28] = -1.28000000;
        fU12[29] = {-156.55000000, 355.53000000, 167.60000000};
        fU400[29] = -1.28000000;
        fU12[30] = {-154.26000000, 355.51000000, 167.60000000};
        fU400[30] = -1.28000000;
        fU12[31] = {-152.00000000, 355.73000000, 167.60000000};
        fU400[31] = -1.28000000;
		local rdn = math.random(0, 31)
		local x, y, z = fU12[rdn][1], fU12[rdn][2], fU12[rdn][3]
		local h = fU400[rdn]
		return x, y, z, h
	elseif(I == 5) then
		fU12[0] = {-148.59000000, 195.91000000, 263.44000000};
        fU400[0] = 135.56000000;
        fU12[1] = {-148.47000000, 210.78000000, 263.44000000};
        fU400[1] = 40.78000000;
        fU12[2] = {-133.75000000, 210.75000000, 263.44000000};
        fU400[2] = -49.02000000;
        fU12[3] = {-133.77000000, 196.08000000, 263.44000000};
        fU400[3] = -135.16000000;
        fU12[4] = {-116.24000000, 211.22000000, 248.11000000};
        fU400[4] = -47.89000000;
        fU12[5] = {-117.37000000, 211.31000000, 247.10000000};
        fU400[5] = -1.07000000;
        fU12[6] = {-116.09000000, 195.52000000, 247.10000000};
        fU400[6] = -160.03000000;
        fU12[7] = {-117.22000000, 195.50000000, 247.10000000};
        fU400[7] = -180.00000000;
        fU12[8] = {-133.27000000, 178.51000000, 247.10000000};
        fU400[9] = -106.94000000;
        fU12[9] = {-133.24000000, 180.54000000, 247.10000000};
        fU400[9] = -89.87001000;
        fU12[10] = {-148.91000000, 178.48000000, 247.10000000};
        fU400[10] = 104.90000000;
        fU12[11] = {-148.93000000, 180.69000000, 247.10000000};
        fU400[11] = 89.28000000;
        fU12[12] = {-166.07000000, 195.57000000, 247.10000000};
        fU400[12] = 168.45000000;
        fU12[13] = {-163.72000000, 195.57000000, 247.10000000};
        fU400[13] = -178.86000000;
        fU12[14] = {-166.12000000, 211.28000000, 247.10000000};
        fU400[14] = 8.58000000;
        fU12[15] = {-164.14000000, 211.26000000, 247.10000000};
        fU400[15] = -3.71000000;
        fU12[16] = {-148.93000000, 228.32000000, 247.10000000};
        fU400[16] = 83.91001000;
        fU12[17] = {-148.95000000, 226.26000000, 247.10000000};
        fU400[17] = 92.23000000;
        fU12[18] = {-133.30000000, 228.31000000, 247.10000000};
        fU400[18] = -85.96000000;
        fU12[19] = {-133.29000000, 226.26000000, 247.10000000};
        fU400[19] = -89.56000000;
        fU12[20] = {-125.56000000, 220.60000000, 237.60000000};
        fU400[20] = -33.21000000;
        fU12[21] = {-128.69000000, 222.04000000, 237.60000000};
        fU400[21] = -10.10000000;
        fU12[22] = {-122.68000000, 217.99000000, 237.60000000};
        fU400[22] = -67.19000000;
        fU12[23] = {-124.41000000, 187.33000000, 237.60000000};
        fU400[23] = -125.07000000;
        fU12[24] = {-122.27000000, 191.46000000, 237.60000000};
        fU400[24] = -98.42000000;
        fU12[25] = {-127.34000000, 184.28000000, 237.60000000};
        fU400[25] = -165.86000000;
        fU12[26] = {-157.86000000, 186.89000000, 237.60000000};
        fU400[26] = 135.64000000;
        fU12[27] = {-153.75000000, 186.89000000, 237.60000000};
        fU400[27] = 170.92000000;
        fU12[28] = {-160.48000000, 190.78000000, 237.60000000};
        fU400[28] = 96.86000000;
        fU12[29] = {-158.23000000, 221.32000000, 237.60000000};
        fU400[29] = 45.17000000;
        fU12[30] = {-160.07000000, 216.16000000, 237.60000000};
        fU400[30] = 81.38000000;
        fU12[31] = {-153.25000000, 222.98000000, 237.60000000};
        fU400[31] = 8.25000000;
		local rdn = math.random(0, 31)
		local x, y, z = fU12[rdn][1], fU12[rdn][2], fU12[rdn][3]
		local h = fU400[rdn]
		return x, y, z, h
	elseif(I == 6) then
		fU12[0] = {-283.22000000, 243.82000000, 227.49000000};
        fU400[0] = 19.36000000;
        fU12[1] = {-295.42000000, 231.49000000, 227.49000000};
        fU400[1] = 77.62000000;
        fU12[2] = {-295.50000000, 199.95000000, 227.49000000};
        fU400[2] = 107.94000000;
        fU12[3] = {-283.15000000, 187.72000000, 227.49000000};
        fU400[3] = 161.68000000;
        fU12[4] = {-251.65000000, 187.74000000, 227.49000000};
        fU400[4] = -168.94000000;
        fU12[5] = {-239.44000000, 199.99000000, 227.49000000};
        fU400[5] = -107.42000000;
        fU12[6] = {-239.33000000, 231.47000000, 227.49000000};
        fU400[6] = -78.34000000;
        fU12[7] = {-251.61000000, 243.72000000, 227.49000000};
        fU400[7] = -21.89000000;
        fU12[8] = {-252.71000000, 242.25000000, 227.49000000};
        fU400[9] = 43.54000000;
        fU12[9] = {-253.41000000, 241.12000000, 227.49000000};
        fU400[9] = 43.54000000;
        fU12[10] = {-254.05000000, 240.14000000, 227.49000000};
        fU400[10] = 43.54000000;
        fU12[11] = {-282.41000000, 242.93000000, 227.49000000};
        fU400[11] = -43.37000000;
        fU12[12] = {-281.89000000, 242.10000000, 227.49000000};
        fU400[12] = -43.47000000;
        fU12[13] = {-281.30000000, 241.18000000, 227.49000000};
        fU400[13] = -43.47000000;
        fU12[14] = {-294.34000000, 230.60000000, 227.49000000};
        fU400[14] = 134.05000000;
        fU12[15] = {-293.03000000, 229.81000000, 227.49000000};
        fU400[15] = 134.05000000;
        fU12[16] = {-291.80000000, 229.01000000, 227.49000000};
        fU400[16] = 134.05000000;
        fU12[17] = {-294.50000000, 200.72000000, 227.49000000};
        fU400[17] = 46.10000000;
        fU12[18] = {-293.25000000, 201.54000000, 227.49000000};
        fU400[18] = 46.10000000;
        fU12[19] = {-291.92000000, 202.37000000, 227.49000000};
        fU400[19] = 46.10000000;
        fU12[20] = {-282.32000000, 188.68000000, 227.49000000};
        fU400[20] = -129.14000000;
        fU12[21] = {-281.55000000, 189.96000000, 227.49000000};
        fU400[21] = -129.14000000;
        fU12[22] = {-280.79000000, 191.10000000, 227.49000000};
        fU400[22] = -129.14000000;
        fU12[23] = {-252.29000000, 188.46000000, 227.49000000};
        fU400[23] = 120.27000000;
        fU12[24] = {-252.97000000, 189.54000000, 227.49000000};
        fU400[24] = 120.27000000;
        fU12[25] = {-253.84000000, 190.80000000, 227.49000000};
        fU400[25] = 120.27000000;
        fU12[26] = {-239.93000000, 200.51000000, 227.49000000};
        fU400[26] = -39.08000000;
        fU12[27] = {-241.12000000, 201.25000000, 227.49000000};
        fU400[27] = -39.08000000;
        fU12[28] = {-242.10000000, 201.89000000, 227.49000000};
        fU400[28] = -39.08000000;
        fU12[29] = {-240.15000000, 230.75000000, 227.49000000};
        fU400[29] = -135.28000000;
        fU12[30] = {-241.49000000, 229.93000000, 227.49000000};
        fU400[30] = -135.28000000;
        fU12[31] = {-242.64000000, 229.20000000, 227.49000000};
        fU400[31] = -135.28000000;
		local rdn = math.random(0, 31)
		local x, y, z = fU12[rdn][1], fU12[rdn][2], fU12[rdn][3]
		local h = fU400[rdn]
		return x, y, z, h
	elseif(I == 7) then
		fU12[0] = {-161.47400000, 14.37160000, 211.07350000};
        fU400[0] = 2.86430000;
        fU12[1] = {-162.03000000, 13.31000000, 210.54000000};
        fU400[1] = 60.82000000;
        fU12[2] = {-161.22000000, 13.21000000, 210.43100000};
        fU400[2] = -104.44000000;
        fU12[3] = {-166.10000000, -36.76000000, 211.69000000};
        fU400[3] = 178.22000000;
        fU12[4] = {-163.78000000, -36.76000000, 211.69000000};
        fU400[4] = 178.22000000;
        fU12[5] = {-168.01000000, -36.76000000, 211.69000000};
        fU400[5] = 178.22000000;
        fU12[6] = {-162.16000000, -36.79000000, 211.69000000};
        fU400[6] = 178.22000000;
        fU12[7] = {-170.03000000, -36.79000000, 211.69000000};
        fU400[7] = 178.22000000;
        fU12[8] = {-160.20000000, -36.79000000, 211.69000000};
        fU400[9] = 178.22000000;
        fU12[9] = {-171.95000000, -36.79000000, 211.69000000};
        fU400[9] = 178.22000000;
        fU12[10] = {-158.22000000, -36.79000000, 211.69000000};
        fU400[10] = 178.22000000;
        fU12[11] = {-173.88000000, -36.79000000, 211.69000000};
        fU400[11] = 178.22000000;
        fU12[12] = {-156.17000000, -36.79000000, 211.69000000};
        fU400[12] = 178.22000000;
        fU12[13] = {-175.89000000, -36.79000000, 211.69000000};
        fU400[13] = 178.22000000;
        fU12[14] = {-154.25000000, -36.79000000, 211.69000000};
        fU400[14] = 178.22000000;
        fU12[15] = {-177.84000000, -36.79000000, 211.69000000};
        fU400[15] = 178.22000000;
        fU12[16] = {-152.47000000, -36.79000000, 211.69000000};
        fU400[16] = 178.22000000;
        fU12[17] = {-179.42000000, -36.79000000, 211.69000000};
        fU400[17] = 178.22000000;
        fU12[18] = {-150.69000000, -36.79000000, 211.69000000};
        fU400[18] = 178.22000000;
        fU12[19] = {-181.17000000, -36.79000000, 211.69000000};
        fU400[19] = 178.22000000;
        fU12[20] = {-183.06000000, -36.79000000, 211.69000000};
        fU400[20] = 178.22000000;
        fU12[21] = {-149.21000000, -36.79000000, 211.69000000};
        fU400[21] = 178.22000000;
        fU12[22] = {-149.56000000, -35.42000000, 211.69000000};
        fU400[22] = -73.20000000;
        fU12[23] = {-150.01000000, -33.88000000, 211.69000000};
        fU400[23] = -73.20000000;
        fU12[24] = {-150.47000000, -32.20000000, 211.69000000};
        fU400[24] = -73.20000000;
        fU12[25] = {-150.93000000, -30.64000000, 211.69000000};
        fU400[25] = -73.20000000;
        fU12[26] = {-151.39000000, -28.90000000, 211.69000000};
        fU400[26] = -73.20000000;
        fU12[27] = {-151.74000000, -27.45000000, 211.69000000};
        fU400[27] = -73.20000000;
        fU12[28] = {-152.12000000, -27.45000000, 211.69000000};
        fU400[28] = -73.20000000;
        fU12[29] = {-152.53000000, -24.70000000, 211.69000000};
        fU400[29] = -73.20000000;
        fU12[30] = {-152.93000000, -23.23000000, 211.69000000};
        fU400[30] = -73.20000000;
        fU12[31] = {-153.32000000, -21.78000000, 211.69000000};
        fU400[31] = -73.20000000;
		local rdn = math.random(0, 31)
		local x, y, z = fU12[rdn][1], fU12[rdn][2], fU12[rdn][3]
		local h = fU400[rdn]
		return x, y, z, h
	elseif(I == 8) then
		fU12[0] = {1284.63000000, 604.91000000, 170.55000000};
        fU400[0] = 91.37000000;
        fU12[1] = {1284.63000000, 596.96000000, 170.55000000};
        fU400[1] = 91.37000000;
        fU12[2] = {1305.12000000, 617.41000000, 170.55000000};
        fU400[2] = -2.57000000;
        fU12[3] = {1297.08000000, 617.41000000, 170.55000000};
        fU400[3] = -2.57000000;
        fU12[4] = {1317.27000000, 604.75000000, 170.55000000};
        fU400[4] = -92.02000000;
        fU12[5] = {1317.27000000, 598.85000000, 170.55000000};
        fU400[5] = -92.02000000;
        fU12[6] = {1317.39000000, 604.78990000, 170.55000000};
        fU400[6] = -90.24000000;
        fU12[7] = {1317.39000000, 596.88000000, 170.55000000};
        fU400[7] = -90.24000000;
        fU12[8] = {1315.61000000, 588.32000000, 170.55000000};
        fU400[9] = -131.22000000;
        fU12[9] = {1313.65000000, 586.27000000, 170.55000000};
        fU400[9] = -131.22000000;
        fU12[10] = {1288.35000000, 586.34000000, 170.55000000};
        fU400[10] = 132.43000000;
        fU12[11] = {1286.21000000, 588.19000000, 170.55000000};
        fU400[11] = 132.43000000;
        fU12[12] = {1286.27000000, 613.84000000, 170.55000000};
        fU400[12] = 46.15000000;
        fU12[13] = {1288.35000000, 615.62000000, 170.55000000};
        fU400[13] = 46.15000000;
        fU12[14] = {1313.80000000, 615.68000000, 170.55000000};
        fU400[14] = -45.49000000;
        fU12[15] = {1315.71000000, 613.67000000, 170.55000000};
        fU400[15] = -45.49000000;
        fU12[16] = {1284.32000000, 613.74000000, 164.62000000};
        fU400[16] = 45.75000000;
        fU12[17] = {1286.31000000, 615.72990000, 164.62000000};
        fU400[17] = 45.75000000;
        fU12[18] = {1288.44000000, 617.72000000, 164.62000000};
        fU400[18] = 45.75000000;
        fU12[19] = {1313.65000000, 617.55000000, 164.62000000};
        fU400[19] = -49.12000000;
        fU12[20] = {1315.64000000, 615.62000000, 164.62000000};
        fU400[20] = -49.12000000;
        fU12[21] = {1317.57000000, 613.67000000, 164.62000000};
        fU400[21] = -42.24000000;
        fU12[22] = {1317.61000000, 588.03000000, 164.62000000};
        fU400[22] = -138.11000000;
        fU12[23] = {1315.58000000, 586.20000000, 164.62000000};
        fU400[23] = -138.11000000;
        fU12[24] = {1313.57000000, 584.38000000, 164.62000000};
        fU400[24] = -139.63000000;
        fU12[25] = {1288.30000000, 584.39000000, 164.62000000};
        fU400[25] = 130.56000000;
        fU12[26] = {1286.42000000, 586.21010000, 164.62000000};
        fU400[26] = 130.56000000;
        fU12[27] = {1284.48000000, 588.34000000, 164.62000000};
        fU400[27] = 150.68000000;
        fU12[28] = {1284.80000000, 600.91000000, 170.80000000};
        fU400[28] = 83.19000000;
        fU12[29] = {1300.99000000, 617.26000000, 170.80000000};
        fU400[29] = -6.25000000;
        fU12[30] = {1317.33000000, 600.91000000, 170.80000000};
        fU400[30] = -91.38000000;
        fU12[31] = {1301.00000000, 584.62000000, 170.80000000};
        fU400[31] = 166.05000000;
		local rdn = math.random(0, 31)
		local x, y, z = fU12[rdn][1], fU12[rdn][2], fU12[rdn][3]
		local h = fU400[rdn]
		return x, y, z, h
	elseif(I == 9) then
		fU12[0] = {-1290.27000000, 931.49000000, 172.87000000};
        fU400[0] = 0.00000000;
        fU12[1] = {-1291.42000000, 931.73000000, 172.87000000};
        fU400[1] = 0.00000000;
        fU12[2] = {-1292.91000000, 931.39000000, 172.87000000};
        fU400[2] = 0.00000000;
        fU12[3] = {-1291.42000000, 930.08000000, 172.87000000};
        fU400[3] = 0.00000000;
        fU12[4] = {-1292.90000000, 930.15000000, 172.87000000};
        fU400[4] = 0.00000000;
        fU12[5] = {-1290.07000000, 929.98000000, 172.87000000};
        fU400[5] = 0.00000000;
        fU12[6] = {-1291.42000000, 928.97000000, 172.87000000};
        fU400[6] = 0.00000000;
        fU12[7] = {-1292.90000000, 928.95000000, 172.87000000};
        fU400[7] = 0.00000000;
        fU12[8] = {-1291.42000000, 928.15000000, 172.87000000};
        fU400[9] = 0.00000000;
        fU12[9] = {-1290.07000000, 928.19000000, 172.87000000};
        fU400[9] = 0.00000000;
        fU12[10] = {-1291.42000000, 926.99000000, 172.87000000};
        fU400[10] = 0.00000000;
        fU12[11] = {-1292.90000000, 926.99000000, 172.87000000};
        fU400[11] = 0.00000000;
        fU12[12] = {-1290.07000000, 926.99000000, 172.87000000};
        fU400[12] = 0.00000000;
        fU12[13] = {-1291.42000000, 925.87000000, 172.87000000};
        fU400[13] = 0.00000000;
        fU12[14] = {-1292.90000000, 925.87000000, 172.87000000};
        fU400[14] = 0.00000000;
        fU12[15] = {-1290.07000000, 925.87000000, 172.87000000};
        fU400[15] = 0.00000000;
        fU12[16] = {-1291.42000000, 924.57000000, 172.87000000};
        fU400[16] = 0.00000000;
        fU12[17] = {-1292.90000000, 924.57000000, 172.87000000};
        fU400[17] = 0.00000000;
        fU12[18] = {-1290.07000000, 924.57000000, 172.87000000};
        fU400[18] = 0.00000000;
        fU12[19] = {-1291.42000000, 923.33000000, 172.87000000};
        fU400[19] = 0.00000000;
        fU12[20] = {-1292.90000000, 923.33000000, 172.87000000};
        fU400[20] = 0.00000000;
        fU12[21] = {-1290.07000000, 923.33000000, 172.87000000};
        fU400[21] = 0.00000000;
        fU12[22] = {-1291.42000000, 921.12000000, 172.87000000};
        fU400[22] = 0.00000000;
        fU12[23] = {-1292.90000000, 921.12000000, 172.87000000};
        fU400[23] = 0.00000000;
        fU12[24] = {-1290.07000000, 921.12000000, 172.87000000};
        fU400[24] = 0.00000000;
        fU12[25] = {-1291.42000000, 918.98000000, 172.87000000};
        fU400[25] = 0.00000000;
        fU12[26] = {-1292.90000000, 918.98000000, 172.87000000};
        fU400[26] = 0.00000000;
        fU12[27] = {-1290.07000000, 918.98000000, 172.87000000};
        fU400[27] = 0.00000000;
        fU12[28] = {-1291.42000000, 916.94000000, 172.87000000};
        fU400[28] = 0.00000000;
        fU12[29] = {-1292.90000000, 916.94000000, 172.87000000};
        fU400[29] = 0.00000000;
        fU12[30] = {-1290.07000000, 916.94000000, 172.87000000};
        fU400[30] = 0.00000000;
        fU12[31] = {-1291.42000000, 915.00000000, 172.87000000};
        fU400[31] = 0.00000000;
		local rdn = math.random(0, 31)
		local x, y, z = fU12[rdn][1], fU12[rdn][2], fU12[rdn][3]
		local h = fU400[rdn]
		return x, y, z, h
	end
end

for i = 1, 15, 1 do
	blips[i] = nil
end

local function TeleportPlayerToJump(jump)
    local playerId = Game.GetPlayerId()
    local playerChar = Game.GetPlayerChar(playerId)
    
	Game.ClearHelp()
	Game.ClearCharTasksImmediately(playerChar)
	--if Game.HasCharGotWeapon(playerChar, parachuteWeaponId) then
		--Game.RemoveWeaponFromChar(playerChar, parachuteWeaponId)
	--end
	if Game.IsCharInAnyCar(playerChar) then
		Game.WarpCharFromCarToCoord(playerChar, jump.x, jump.y, jump.z)
	else
		Game.SetCharCoordinates(playerChar, jump.x, jump.y, jump.z)
	end
	Game.SetCharHeading(playerChar, jump.h)
	Game.SetCharDucking(playerChar, false)
	Game.SetGameCamHeading(0.0)
	Game.RequestAllSlodsInWorld()
	Game.LoadAllObjectsNow()
	Game.StartLoadScene(jump.x, jump.y, jump.z) 
end

local function FadeOut(jump)
    if not Game.IsScreenFadedOut() then
		Game.DoScreenFadeOut(500)

		-- Wait for the screen to finish fading out.
		while Game.IsScreenFadingOut() do
			Thread.Pause(0)
		end
	end
	Thread.Pause(1000)
    TeleportPlayerToJump(jump)
	Zground = jump.z
end

local function FadeIn()
	Game.ForceLoadingScreen(false)
	Game.DoScreenFadeIn(500)
end

local function AddJumpBlips()
	local episode = Game.GetCurrentEpisode()

	if episode == 2 then
		for i, startjump in ipairs(startjumpPoints) do
			if blips[i] == nil then
				blips[i] = Game.AddBlipForCoord(startjump.x, startjump.y, startjump.z)
				Game.ChangeBlipSprite(blips[i], 106)
				Game.ChangeBlipDisplay(blips[i], 2)
				Game.ChangeBlipPriority(blips[i], 0)
				Game.SetBlipAsShortRange(blips[i], true)
            end
        end
    end
end

local function RemoveJumpBlips()
    for i, blip in ipairs(blips) do
        if blips[i] ~= nil then
            Game.RemoveBlipAndClearIndex(blips[i])
            blips[i] = nil
        end
    end
end

function GiveParachute()
    local playerId = Game.GetPlayerId()
    local playerChar = Game.GetPlayerChar(playerId)

	if IsPlayerModelsMP() then
		Game.SetCharComponentVariation(playerChar, 8, 1, 0) -- parachute clothes
		CreateParachuteSacObject()
	else
		CreateParachuteSacObject()
		CreateFakeParachuteSac()
	end
end

local ResetClearHelp = false

local function PrintHelpEnter(sParam1, sVar5)
	if (not Game.IsThisHelpMessageWithStringBeingDisplayed( sParam1, sVar5 ) and not ResetClearHelp) then 
		--if (not Game.IsHelpMessageBeingDisplayed()) then 
			Game.PrintHelpForeverWithString( sParam1, sVar5 );
			ResetClearHelp = true
		--end
	end
end

function SwithMod(I)
	if state ~= I then 
		state = I
		DebugPrint("Script basejumplauncher_mp : "..I)
	end
end


-- Boucle principale
local function MainLoop()
    local playerId = Game.GetPlayerId()
    local playerChar = Game.GetPlayerChar(playerId)
    
    if state == 1 then
		if not Game.IsCharDead(playerChar) and Game.IsNetworkPlayerActive(playerId) then 
			-- Attente que le joueur s'approche d'un point de saut
			for i, jump in ipairs(startjumpPoints) do
				--if IsPlayerAtJump(jump) then
				if(IsPlayerNearCoords(jump.x, jump.y, jump.z, 50)) then 
					if (Game.LocateCharOnFoot3d( playerChar,  jump.x, jump.y, jump.z + 0.50000000, 1.50000000, 1.50000000, 1.00000000, true ) ) then
						
						PrintHelpEnter("bj_prmpt", "CNTBUT2") 
						if(Game.IsGameKeyboardKeyJustPressed(18) or Game.IsButtonJustPressed(0, 0x4)) then
							local tpx, tpy, tpz, tph = TeleportPositions(i) -- utils.h
							currentJump = {x=tpx, y=tpy, z=tpz, h=tph}
							FadeOut(currentJump)
							SwithMod(2)
							break
						end
					else
						if ResetClearHelp then
							ResetClearHelp = false
							Game.ClearHelp()
						end
					end
				end
			end
		end
    elseif state == 2 then
        if Game.IsScreenFadedOut() and Game.UpdateLoadScene() then
            FadeIn()
			GiveParachute()
			Game.GiveWeaponToChar(playerChar, 0, 1, true)
			ScriptActivated = true
			Game.SetCharVelocity(playerChar, 0.0, 0.0, -5.0)
            SwithMod(4)
        end
    elseif state == 4 then

    end

	if(state >= 1) then 
		if Game.IsCharDead(playerChar) then
			SwithMod(1)
			Zground = 0
			ScriptActivated = false
		end
	end
end

Events.Subscribe("scriptInit", function()

	Thread.Create(function()
        AddJumpBlips()
		Console.Log("basejumplauncher_mp.lua version "..version)
		while true do
			Thread.Pause(0)
			local episode = Game.GetCurrentEpisode()
			
			if episode == 2 then
				MainLoop()
			end
		end
	end)
end)